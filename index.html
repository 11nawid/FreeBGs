<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>FreeBGs - All Media</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" href="https://11nawid.github.io/FreeBGs/favicon.png">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .loader {
      border: 4px solid #ccc;
      border-top: 4px solid #3490dc;
      border-radius: 50%;
      width: 36px;
      height: 36px;
      animation: spin 1s linear infinite;
      margin: auto;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    .media-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1.5rem;
    }
    .media-preview {
      height: 200px;
      background-color: #2d3748;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }
    .media-preview img,
    .media-preview video {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
    }
    .filename, .url-input {
      word-break: break-word;
      overflow-wrap: break-word;
    }
    .url-input {
      white-space: nowrap;
      overflow-x: auto;
    }
  </style>
</head>
<body class="bg-gray-900 text-white min-h-screen py-10 px-4 sm:px-8">
  <div class="max-w-6xl mx-auto">
    <h1 class="text-3xl font-bold mb-6 text-center">ðŸŽ¬ FreeBGs - All Media</h1>
    <div id="media" class="media-container"><div class="loader"></div></div>
  </div>

  <script>
    const GITHUB_USERNAME = "11nawid";
    const REPO_NAME = "FreeBGs";
    const BASE_FOLDER = "media";
    const API_URL = `https://api.github.com/repos/${GITHUB_USERNAME}/${REPO_NAME}/contents/${BASE_FOLDER}`;
    const RAW_URL = `https://${GITHUB_USERNAME}.github.io/${REPO_NAME}/${BASE_FOLDER}/`;

    const IMAGE_EXTS = ['.jpg', '.jpeg', '.png', '.webp'];
    const GIF_EXTS = ['.gif'];
    const VIDEO_EXTS = ['.mp4', '.webm', '.mov'];

    async function loadMedia() {
      const container = document.getElementById("media");
      container.innerHTML = "<div class='loader'></div>";

      try {
        const res = await fetch(API_URL);
        const files = await res.json();
        if (!Array.isArray(files)) throw new Error("Invalid response");

        const mediaFiles = files.filter(file => file.type === "file");

        container.innerHTML = "";

        mediaFiles.forEach(file => {
          const url = `${RAW_URL}${file.name}`;
          const name = file.name.toLowerCase();

          let type = "unknown";
          if (VIDEO_EXTS.some(ext => name.endsWith(ext))) type = "video";
          else if (GIF_EXTS.some(ext => name.endsWith(ext))) type = "gif";
          else if (IMAGE_EXTS.some(ext => name.endsWith(ext))) type = "image";

          const div = document.createElement("div");
          div.className = "bg-gray-800 rounded-lg shadow p-4";

          let mediaHTML = "";
          if (type === "video") {
            mediaHTML = `<div class="media-preview"><video src="${url}" controls loop muted playsinline></video></div>`;
          } else if (type === "image" || type === "gif") {
            mediaHTML = `<div class="media-preview"><img src="${url}" alt="${file.name}" loading="lazy"></div>`;
          } else {
            return; // skip unknown
          }

          div.innerHTML = `
            ${mediaHTML}
            <h3 class="text-lg font-semibold mt-3 filename">${file.name}</h3>
            <input class="w-full text-sm bg-gray-700 text-gray-200 px-3 py-1 rounded border border-gray-600 url-input mt-2" value="${url}" readonly onclick="this.select()">
            <button onclick="copyURL(this)" class="mt-2 w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-1 rounded text-sm">ðŸ“‹ Copy URL</button>
          `;
          container.appendChild(div);
        });
      } catch (err) {
        container.innerHTML = `<p class="text-center text-red-500">Failed to load media.</p>`;
        console.error("Error fetching media:", err);
      }
    }

    function copyURL(button) {
      const input = button.previousElementSibling;
      input.select();
      document.execCommand("copy");
      button.innerText = "âœ… Copied!";
      setTimeout(() => button.innerText = "ðŸ“‹ Copy URL", 1500);
    }

    document.addEventListener("DOMContentLoaded", loadMedia);
  </script>
</body>
</html>
