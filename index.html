<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>FreeBGs - Aesthetic Backgrounds</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Free video, gif, and image backgrounds for developers. Just copy & use!">
  <link rel="icon" href="https://11nawid.github.io/FreeBGs/favicon.png">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .loader {
      border: 4px solid #ccc;
      border-top: 4px solid #3490dc;
      border-radius: 50%;
      width: 36px;
      height: 36px;
      animation: spin 1s linear infinite;
      margin: auto;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    .media-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1.5rem;
    }
    .media-preview {
      height: 200px;
      background-color: #2d3748;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }
    .media-preview img,
    .media-preview video {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
    }
    .filename {
      word-break: break-word;
    }
  </style>
</head>
<body class="bg-gray-900 text-white min-h-screen py-10 px-4 sm:px-8">
  <div class="max-w-6xl mx-auto">
    <h1 class="text-3xl font-bold mb-4 text-center">ðŸŽ¬ FreeBGs</h1>

    <input id="searchInput" placeholder="Search media by name..." class="mb-6 px-4 py-2 w-full rounded bg-gray-800 border border-gray-600 text-white" oninput="filterMedia()">

    <div id="media" class="media-container"><div class="loader"></div></div>
  </div>

  <script>
    const GITHUB_USERNAME = "11nawid";
    const REPO_NAME = "FreeBGs";
    const BASE_FOLDER = "media";
    const GITHUB_API = `https://api.github.com/repos/${GITHUB_USERNAME}/${REPO_NAME}/contents/${BASE_FOLDER}`;
    const GITHUB_PAGES_BASE = `https://${GITHUB_USERNAME}.github.io/${REPO_NAME}/${BASE_FOLDER}/`;

    const IMAGE_EXTS = ['.jpg', '.jpeg', '.png', '.webp'];
    const GIF_EXTS = ['.gif'];
    const VIDEO_EXTS = ['.mp4', '.webm', '.mov'];

    async function loadMedia() {
      const container = document.getElementById("media");
      container.innerHTML = "<div class='loader'></div>";

      try {
        const res = await fetch(GITHUB_API);
        const files = await res.json();
        if (!Array.isArray(files)) throw new Error("Invalid response");

        const mediaFiles = files.filter(file => file.type === "file");

        container.innerHTML = "";

        mediaFiles.forEach(file => {
          const url = `${GITHUB_PAGES_BASE}${file.name}`;
          const name = file.name.toLowerCase();

          let type = "unknown";
          if (VIDEO_EXTS.some(ext => name.endsWith(ext))) type = "video";
          else if (GIF_EXTS.some(ext => name.endsWith(ext))) type = "gif";
          else if (IMAGE_EXTS.some(ext => name.endsWith(ext))) type = "image";

          const div = document.createElement("div");
          div.className = "bg-gray-800 rounded-lg shadow p-4 media-item";

          let mediaHTML = "";

          if (type === "video") {
            mediaHTML = `
              <div class="media-preview">
                <video class="w-full h-full object-contain" src="${url}" controls loop muted playsinline></video>
              </div>
            `;
          } else if (type === "image" || type === "gif") {
            mediaHTML = `
              <div class="media-preview">
                <img class="w-full h-full object-contain" src="${url}" alt="${file.name}" loading="lazy">
              </div>
            `;
          } else {
            return; // skip unknown types
          }

          div.innerHTML = `
            ${mediaHTML}
            <h3 class="text-lg font-semibold mt-3 filename">${file.name}</h3>
            <div class="mt-2">
              <input class="w-full text-sm bg-gray-700 text-gray-200 px-3 py-1 rounded border border-gray-600 focus:outline-none" 
                     value="${url}" 
                     readonly>
              <button onclick="copyURL(this)" 
                      class="mt-2 w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-1 rounded text-sm">
                ðŸ“‹ Copy URL
              </button>
            </div>
          `;

          container.appendChild(div);
        });
      } catch (error) {
        container.innerHTML = `<p class='text-center text-red-400'>Failed to load media.</p>`;
        console.error("Error loading media:", error);
      }
    }

    function copyURL(button) {
      const input = button.previousElementSibling;
      input.select();
      document.execCommand("copy");
      button.innerText = "âœ… Copied!";
      setTimeout(() => (button.innerText = "ðŸ“‹ Copy URL"), 1500);
    }

    function filterMedia() {
      const term = document.getElementById("searchInput").value.toLowerCase();
      document.querySelectorAll('.media-item').forEach(div => {
        const name = div.querySelector('h3').textContent.toLowerCase();
        div.style.display = name.includes(term) ? 'block' : 'none';
      });
    }

    document.addEventListener("DOMContentLoaded", loadMedia);
  </script>
</body>
</html>
